<script setup>
import { useRouter } from "vue-router";
import { getIndexData } from "@/api/index";
import { useAppAbility } from "@/plugins/casl/useAppAbility";

const router = useRouter();
const ability = useAppAbility();
const avatars = ref("");

const isCardDetailsVisible = ref(false);

const length = ref("");

const index1 = ref("");

const aaa = (i) => {
  if(i===index1.value) {
    index1.value = ''
  } else {
    index1.value = i;
    console.log(index1.value,"xxxxxxxxx");
  }
  
}

const getData = async () => {
  const { data: res } = await getIndexData();
  avatars.value = res;
  avatars.value.reverse();
  length.value = avatars.value.length;
};

const info = (index) => {
  router.push("/inner/" + index);
};

const news = ref([
  {
    type: "news",
    img: "https://www.uesg.org.cn/img/0725/2.jpeg",
    title: "ESGÁöÑÂê´‰πâ„ÄÇ",
    tag: "ÁßëÊôÆ",
    time: "2023.07.23",
    views: "9K+",
    desc: "ESGËß£Èáä‰∏∫‚ÄúEnvironmentalÁéØÂ¢É‚Äù„ÄÅ‚ÄúSocialÁ§æ‰ºö‚ÄùÂíå‚ÄúGovernanceÊ≤ªÁêÜ‚Äù„ÄÇ",
  },
  {
    type: "news",
    img: "https://www.uesg.org.cn/img/0725/3.jpeg",
    title: "‰∏≠ÂõΩÁâπËâ≤ÁöÑESG„ÄÇ",
    tag: "ÁßëÊôÆ",
    time: "2023.07.23",
    views: "9K+",
    desc: "‰∏≠ÂõΩÊòØ‰∏ñÁïå‰∏äÊúÄÂ§ß„ÄÅÊúÄÊúâÊ¥ªÂäõÁöÑÁªèÊµé‰Ωì‰πã‰∏ÄÔºå‰∏≠ÂõΩ‰ºÅ‰∏öÊõ¥ÊòØ‰∏≠ÂõΩÁªèÊµéÂèëÂ±ïÁöÑÈáçË¶ÅÂä®Âäõ„ÄÇ‰ª•ÂØπÁéØÂ¢ÉÂèãÂ•Ω„ÄÅÂØπÁ§æ‰ºöË¥üË¥£‰ªªÁöÑÊñπÂºè‰øÉËøõ‰∏≠ÂõΩÂíå‰∏ñÁïåÁπÅËç£„ÄÇ",
  },
  {
    type: "news",
    img: "https://www.uesg.org.cn/img/0725/4.jpeg",
    title: "ESGÂØπ‰ºÅ‰∏öÁöÑ‰ΩúÁî®„ÄÇ",
    tag: "ÁßëÊôÆ",
    time: "2023.07.23",
    views: "9K+",
    desc: "ÂÖ®ÁêÉÊ∞îÂÄôÂç±Êú∫ÂΩìÂâçÔºåÊØè‰∏™ÂõΩÂÆ∂„ÄÅÊØè‰∏™‰ºÅ‰∏ö‰πÉËá≥ÊØè‰∏™‰∫∫ÈÉΩË¥£Êó†ÊóÅË¥∑„ÄÇ‰ºÅ‰∏öÂ∫î‰∏çÊñ≠ÂÆåÂñÑËÑ±Á¢≥Á≠ñÁï•Âíå‰∏æÊé™ÔºåÂáèÂ∞ë‰ºÅ‰∏öËøêËê•Âíå‰ª∑ÂÄºÈìæÂØπÁéØÂ¢ÉÁöÑÂΩ±ÂìçÔºåÂºïÈ¢Ü‰ºÅ‰∏öÁªøËâ≤ËΩ¨Âûã„ÄÇ",
  },
  {
    type: "report",
    img: "https://www.uesg.org.cn/img/0725/5.jpeg",
    title: "Ë¥üË¥£‰∫∫ÁöÑÁßëÊäÄÔºåÂèØÊåÅÁª≠ÁöÑÊú™Êù•„ÄÇ",
    tag: "ÂÄ°ÂØºESGÁöÑ‰ºÅ‰∏ö",
    time: "2023.07.23",
    views: "9K+",
    desc: "ÂèòÂåñ‰πã‰∏≠‰πüÊúâ‰∏çÂèòÔºåËøôÊ≠£ÊòØÊàë‰ª¨ÂßãÁªàÁöÑÂùöÊåÅ„ÄÇESGÂ∞ÜÊàê‰∏∫ÊéßËÇ°ÈõÜÂõ¢‰∏é‰∏öÂä°ÈõÜÂõ¢ÁöÑÊ≤ªÁêÜÁ∫ΩÂ∏¶Âíå‰ª∑ÂÄºÁ∫ΩÂ∏¶ÔºåÊé®Âä®ÈòøÈáåÂ∑¥Â∑¥ÊåÅÁª≠ÂÅö‚ÄúÂ•ΩÂÖ¨Âè∏‚ÄùÔºåÊàê‰∏∫ÂèØÊåÅÁª≠ÂèëÂ±ïÈ¢ÜÂüüÁöÑÈ¢ÜÂÜõËÄÖ„ÄÇ",
  },
  {
    type: "report",
    img: "https://www.uesg.org.cn/img/0725/6.jpeg",
    title: "‰∏âÁÆ°ÈΩê‰∏ãÔºåÈΩêÂ§¥Âπ∂Ëøõ„ÄÇ",
    tag: "ÂÄ°ÂØºESGÁöÑ‰ºÅ‰∏ö",
    time: "2023.07.23",
    views: "9K+",
    desc: "ËøáÂéª‰∏ÄÂπ¥‰∏≠ÔºåËÖæËÆØÂú®ÁéØÂ¢É„ÄÅÁ§æ‰ºöÂèäÁÆ°Ê≤ªÔºàESGÔºâÊñπÈù¢ÂùáÂèñÂæóÁ®≥Ê≠•ËøõÂ±ï„ÄÇËÖæËÆØ‰∫éÊú¨Âë®ÂèëÂ∏ÉÂÖ∂2022Âπ¥Â∫¶ESGÊä•ÂëäÔºåÂÖ®Èù¢ÈòêËø∞‰∫ÜËá™Ë∫´ÁöÑ‰∏æÊé™‰∏éÊàêÊûúÔºåÂåÖÊã¨Êé®ËøõÁ¢≥‰∏≠ÂíåÂèëÂ±ïÔºå‰øùÊä§ÁîüÁâ©Â§öÊ†∑ÊÄßÔºåÊèêÂçáÂ§öÂÖÉ„ÄÅÂπ≥Á≠â‰∏éÂÖ±ËûçÔºàDEIÔºâÔºåÊé®Âä®ÂèØÊåÅÁª≠Á§æ‰ºö‰ª∑ÂÄºÂàõÊñ∞„ÄÇ",
  },
  {
    type: "report",
    img: "https://www.uesg.org.cn/img/0725/7.jpeg",
    title: "‰∏∫Áî®Êà∑„ÄÅÂëòÂ∑•„ÄÅ‰πÉËá≥ÂÖ®‰∫∫Á±ªÊèê‰æõÊîØÊåÅ„ÄÇ",
    tag: "ÂÄ°ÂØºESGÁöÑ‰ºÅ‰∏ö",
    time: "2023.07.23",
    views: "9K+",
    desc: "Â∞èÁ±≥‰Ωú‰∏∫‰∏ÄÂÆ∂‰ª•Êô∫ËÉΩÊâãÊú∫„ÄÅÊô∫ËÉΩÁ°¨‰ª∂ÂíåIoTÂπ≥Âè∞‰∏∫Ê†∏ÂøÉÁöÑÊ∂àË¥πÁîµÂ≠êÂèäÊô∫ËÉΩÂà∂ÈÄ†ÂÖ¨Âè∏ÔºåÂä™ÂäõÂá≠ÂÄüÂÖ¨Âè∏Âú®ËßÑÊ®°ÂíåËøê‰ΩúÊïàÁéá‰∏äÁöÑ‰ºòÂäøÔºå‰∏çÊñ≠‰øÉËøõÂèØÊåÅÁª≠ÁªèÊµéÁöÑÂèëÂ±ïÔºå‰∏∫Êàë‰ª¨ÁöÑÁî®Êà∑„ÄÅÂëòÂ∑•„ÄÅÂÖ¨Âè∏Êú¨Ë∫´‰πÉËá≥ÂÖ®‰∫∫Á±ªÊèê‰æõÊîØÊåÅ„ÄÇ",
  },
]);


onMounted(() => {
  // Âú®È°µÈù¢Âä†ËΩΩÊó∂ÊâßË°åÁöÑÊñπÊ≥ï
  getData();

  const userAbilities = [
    {
      action: "manage",
      subject: "all",
    },
  ];
  localStorage.setItem("userAbilities", JSON.stringify(userAbilities));
  ability.update(userAbilities);
  // localStorage.setItem("info_islogin", true);
});
</script>

<template>
  <VRow>
    <!-- üëâ Popular Uses Of The Internet -->
    <div style="padding: 12px">
      <img
        src="https://www.uesg.org.cn/img/0725/1.jpeg"
        style="width: 100%; border-radius: 6px; display: block"
        alt=""
      />
    </div>

    <VCol cols="12" md="4" sm="6" v-for="(item, index) in news" :key="index">
      <VCard v-if="item.type == 'news'">
        <VImg :src="item.img" style="border-radius: 6px;"/>

        <VCardItem>
          <VCardTitle class="cardTitle">{{ item.title }}</VCardTitle>
          <div class="tools">
            <div class="left">
              <span class="tag">
                {{ item.tag }}
              </span>
              <span style="padding: 0 5px;font-size: 13px;line-height: 18px;color: #00000040;">|</span>
              <span class="time">{{ item.time }}</span>
            </div>

            <div class="right">
              <img
                src="https://www.uesg.org.cn/icon/0725/view_%E7%94%BB%E6%9D%BF%201.svg"
                style="width: 20px; height: 15px"
              />
              <span style="font-size: 12px; color: rgba(47, 43, 61, 0.42)">
                {{ item.views }}
              </span>
            </div>
          </div>
        </VCardItem>

        <VCardText>
          {{ item.desc }}
        </VCardText>

        <VCardActions>
          <VBtn @click="aaa(index)">
            Êü•ÁúãÊõ¥Â§ö
          </VBtn>

          <VSpacer />

          <VBtn
            icon
            size="small"
            @click="isCardDetailsVisible = !isCardDetailsVisible"
          >
            <VIcon
              :icon="
                isCardDetailsVisible
                  ? 'tabler-chevron-up'
                  : 'tabler-chevron-down'
              "
            />
          </VBtn>
        </VCardActions>

        <VExpandTransition>
          <div v-show="index === index1">
            <VDivider />
            <VCardText>
              {{ item.desc }}
            </VCardText>
          </div>
        </VExpandTransition>
      </VCard>
      <VCard v-else>
        <VImg :src="item.img" style="border-radius: 6px;"/>

        <VCardItem>
          <VCardTitle class="cardTitle">{{ item.title }}</VCardTitle>
          <div class="tools">
            <div class="left">
              <span class="tag1">
                {{ item.tag }}
              </span>
              <span style="padding: 0 5px;font-size: 13px;line-height: 18px;color: #00000040;">|</span>
              <span class="time">{{ item.time }}</span>
            </div>

            <div class="right">
              <img
                src="https://www.uesg.org.cn/icon/0725/view_%E7%94%BB%E6%9D%BF%201.svg"
                style="width: 20px; height: 15px"
              />
              <span style="font-size: 12px; color: rgba(47, 43, 61, 0.42)">
                {{ item.views }}
              </span>
            </div>
          </div>
        </VCardItem>

        <VCardText>
          {{ item.desc }}
        </VCardText>

        <VCardActions v-if="item.type == 'news'">
          <VBtn @click="isCardDetailsVisible = !isCardDetailsVisible">
            Êü•ÁúãÊõ¥Â§ö
          </VBtn>

          <VSpacer />

          <VBtn
            icon
            size="small"
            @click="isCardDetailsVisible = !isCardDetailsVisible"
          >
            <VIcon
              :icon="
                isCardDetailsVisible
                  ? 'tabler-chevron-up'
                  : 'tabler-chevron-down'
              "
            />
          </VBtn>
        </VCardActions>
        <VCardText v-else>
          <VBtn size="small" > Êü•ÁúãÊä•Âëä </VBtn>
        </VCardText>


        <VExpandTransition>
          <div v-show="isCardDetailsVisible">
            <VDivider />
            <VCardText>
              {{ item.desc }}
            </VCardText>
          </div>
        </VExpandTransition>
      </VCard>
    </VCol>
  </VRow>
</template>

<style>
.v-card,.v-card-item__content {
  overflow:unset !important;
}
.cardTitle {
  font-size: 20px !important ;
  color: #5c5a68 !important;
  font-weight: 500 !important;
  line-height: 28px !important;
  padding-top: 0 !important;
  padding-bottom: 4px !important;
}
.tools {
  display: flex; 
  justify-content: space-between;
}
.tag {
  position: relative;
  color: #30d158ff;
  font-size: 13px;
  line-height: 18px;
  font-weight: 500;
}
.tag::before {
  content: '';
  position: absolute;
  display: inline-block;
  margin-right: 10px;
  width: 3px;
  height: 14px;
  background-color: #30D158FF;
  vertical-align: middle;
  margin-bottom: 1px;
  left: -24px;
  top: 1px;
}
.tag1 {
  position: relative;
  color: #7367F0FF;
  font-size: 13px;
  line-height: 18px;
  font-weight: 500;
}
.tag1::before {
  content: '';
  position: absolute;
  display: inline-block;
  margin-right: 10px;
  width: 3px;
  height: 14px;
  background-color: #7367F0FF;
  vertical-align: middle;
  margin-bottom: 1px;
  left: -24px;
  top: 1px;
}
.time {
  font-size: 13px;
  line-height: 18px;
  color: #00000040;
}
.right {
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>

<style lang="scss" scoped>
// .v-card-text {
//   padding-top: 0 !important;
// }
.avatar-center {
  position: absolute;
  border: 3px solid rgb(var(--v-theme-surface));
  inset-block-start: -2rem;
  inset-inline-start: 1rem;
}

// membership pricing
.member-pricing-bg {
  position: relative;
  background-color: rgba(var(--v-theme-on-surface), var(--v-hover-opacity));
}

.membership-pricing {
  sup {
    inset-block-start: 9px;
  }
}

.v-btn {
  transform: none;
}
</style>
